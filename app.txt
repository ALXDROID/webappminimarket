const productos = [

  // ðŸ¥¤ BEBIDAS
  {id:1, nombre:"Coca Cola 1.5L", precio:1900, categoria:"Bebidas", img:"coca15.jpg"},
  {id:2, nombre:"Coca Cola Zero 1.5L", precio:1950, categoria:"Bebidas", img:"cocazero15.jpg"},
  {id:3, nombre:"Pepsi 1.5L", precio:1800, categoria:"Bebidas", img:"pepsi15.jpg"},
  {id:4, nombre:"Fanta Naranja 1.5L", precio:1700, categoria:"Bebidas", img:"fanta15.jpg"},
  {id:5, nombre:"Sprite 1.5L", precio:1700, categoria:"Bebidas", img:"sprite15.jpg"},
  {id:6, nombre:"Monster Energy 473ml", precio:1800, categoria:"Bebidas", img:"monster.jpg"},
  {id:7, nombre:"Red Bull 250ml", precio:1600, categoria:"Bebidas", img:"redbull.jpg"},

  // ðŸž PANADERÃA
  {id:8, nombre:"Pan Molde Blanco Ideal", precio:1300, categoria:"PanaderÃ­a", img:"panmolde.jpg"},
  {id:9, nombre:"Pan Molde Integral Ideal", precio:1400, categoria:"PanaderÃ­a", img:"moldeintegral.jpg"},
  {id:10, nombre:"Marraqueta 4 unidades", precio:1000, categoria:"PanaderÃ­a", img:"marraqueta.jpg"},
  {id:11, nombre:"Hallulla 4 unidades", precio:900, categoria:"PanaderÃ­a", img:"hallulla.jpg"},
  {id:12, nombre:"Queque Marmoleado", precio:2500, categoria:"PanaderÃ­a", img:"queque.jpg"},
  {id:13, nombre:"Donuts (pack 4)", precio:1800, categoria:"PanaderÃ­a", img:"donuts.jpg"},

  // ðŸ§‚ ABARROTES
  {id:14, nombre:"Arroz Tucapel 1kg", precio:1200, categoria:"Abarrotes", img:"arroz.jpg"},
  {id:15, nombre:"Fideos Carozzi 400g", precio:900, categoria:"Abarrotes", img:"fideos.jpg"},
  {id:16, nombre:"Aceite Maravilla 1L", precio:1900, categoria:"Abarrotes", img:"aceite.jpg"},
  {id:17, nombre:"AzÃºcar Iansa 1kg", precio:1300, categoria:"Abarrotes", img:"azucar.jpg"},
  {id:18, nombre:"Sal 1kg", precio:600, categoria:"Abarrotes", img:"sal.jpg"},
  {id:19, nombre:"AtÃºn Lomitos en Agua", precio:1100, categoria:"Abarrotes", img:"atun.jpg"},
  {id:20, nombre:"Porotos Hallados 1kg", precio:1700, categoria:"Abarrotes", img:"porotos.jpg"},
  {id:21, nombre:"Salsa de Tomate", precio:700, categoria:"Abarrotes", img:"salsa.jpg"},
  {id:22, nombre:"CafÃ© NescafÃ© TradiciÃ³n 170g", precio:3900, categoria:"Abarrotes", img:"cafe.jpg"},

];



/*const productos = [
  {id:1, nombre:"Coca Cola 1.5L", precio:1900, categoria:"Bebidas", img:"coca.jpg"},
  {id:2, nombre:"Pan Molde", precio:1300,categoria:"PanaderÃ­a", img:"pan.jpg"},
  {id:3, nombre:"Arroz 1kg", precio:1200,categoria:"Abarrotes", img:"arroz.jpg"},
];*/

function toggleDark(){
  document.body.classList.toggle("dark");
  localStorage.setItem("darkmode", document.body.classList.contains("dark"));
}

// cargar estado
if (localStorage.getItem("darkmode") === "true") {
  document.body.classList.add("dark");
}
function filtrarCat(cat){
  if(cat === 'Todos') return mostrarProductos();

  const cont = document.getElementById("productos");
  cont.innerHTML = "";

  productos.filter(p => p.categoria === cat)
    .forEach(p => {
      cont.innerHTML += `
      <div class="col-6">
        <div class="product-card">
          <img src="${p.img}">
          <h6 class="mt-2 fw-bold">${p.nombre}</h6>
          <div class="d-flex justify-content-between align-items-center">
            <span class="price-tag">$${p.precio}</span>
            <button class="btn-add" onclick="agregar(${p.id})">+</button>
          </div>
        </div>
      </div>`;
    });
}
document.getElementById("btnEnviar").onclick = ()=>{
  const tipo = document.getElementById("tipoPedido").value;

  alert("Pedido enviado como: " + tipo);
};
function mostrarProductos(lista = productos) {
  const div = document.getElementById("productos");
  div.innerHTML = "";

  lista.forEach(p => {
    div.innerHTML += `
      <div class="col-6">
        <div class="product-card" onclick="verDetalle(${p.id})" style="cursor:pointer;">
          <img src="${p.img}">
          <h6 class="mt-2 fw-bold">${p.nombre}</h6>
          <div class="d-flex justify-content-between align-items-center">
            <span class="price-tag">$${p.precio}</span>
            <button class="btn-add" onclick="agregar(${p.id}); event.stopPropagation();">+</button>
          </div>
        </div>
      </div>
    `;
  });
}

/*function mostrarProductos() {
  const div = document.getElementById("productos");
  if (!div) return;

  productos.forEach(p => {
    div.innerHTML += `
      <div class="col-6">
      <div onclick="verDetalle(${p.id})" class="product-card" style="cursor:pointer;">
       <img src="${p.img}">
          
          <h6 class="mt-2 fw-bold">${p.nombre}</h6>

          <div class="d-flex justify-content-between align-items-center">
            <span class="price-tag">$${p.precio}</span>
            <button class="btn-add" onclick="agregar(${p.id})">+</button>
          </div>
        </div>
      </div>
    `;
  });
}*/

function obtenerCarrito(){
  return JSON.parse(localStorage.getItem("carrito") || "[]");
}

function guardarCarrito(c){
  localStorage.setItem("carrito", JSON.stringify(c));
}

function agregar(id){
  let carrito = obtenerCarrito();
  let item = carrito.find(x => x.id === id);

  if (item) item.cantidad++;
  else carrito.push({id, cantidad:1});

  guardarCarrito(carrito);
  alert("Agregado al carrito");
}

function mostrarCarrito(){
  const div = document.getElementById("listaCarrito");
  if (!div) return;

  let carrito = obtenerCarrito();
  div.innerHTML = "";

  carrito.forEach(item => {
    let p = productos.find(x => x.id === item.id);

    div.innerHTML += `
      <div class="cart-card mb-2">
        <div class="d-flex justify-content-between">
          <div>
      r      <strong>${p.nombre}</strong><br>
            Cantidad: ${item.cantidad}
          </div>
          <div class="text-success fw-bold">
            $${p.precio * item.cantidad}
          </div>
        </div>
      </div>
    `;
  });
}
function filtrarProductos(texto) {
  const div = document.getElementById("productos");
  div.innerHTML = "";

  productos
    .filter(p => p.nombre.toLowerCase().includes(texto.toLowerCase()))
    .forEach(p => {
      div.innerHTML += `
      <div class="col-6">
        <div class="product-card">
          <img src="${p.img}">
          <h6 class="mt-2 fw-bold">${p.nombre}</h6>
          <div class="d-flex justify-content-between align-items-center">
            <span class="price-tag">$${p.precio}</span>
            <button class="btn-add" onclick="agregar(${p.id})">+</button>
          </div>
        </div>
      </div>`;
    });
}
function obtenerFavs(){
  return JSON.parse(localStorage.getItem("favoritos") || "[]");
}
function logout(){
  localStorage.removeItem("usuario");
  window.location.href = "login.html";
}

function toggleFav(id){
  let fav = obtenerFavs();

  if(fav.includes(id)){
    fav = fav.filter(x=>x!==id);
  } else {
    fav.push(id);
    navigator.vibrate?.(50);
  }

  localStorage.setItem("favoritos", JSON.stringify(fav));
  alert("Favoritos actualizado â¤ï¸");
}

window.addEventListener("DOMContentLoaded", () => {
  mostrarProductos();
mostrarCarrito();
  const buscador = document.getElementById("buscar");
  if (buscador) {
    buscador.addEventListener("input", e => {
      filtrarProductos(e.target.value);
    });
  }
});
function verDetalle(id){
  location.href = "detalle.html?id=" + id;
}

function mostrarDetalle(id){
  const p = productos.find(x => x.id == id);

  document.getElementById("content").innerHTML = `
    <img src="${p.img}" class="w-100 rounded mb-3" style="height:250px;object-fit:cover;">
    <h2>${p.nombre}</h2>
    <p class="fs-4 text-success">$${p.precio}</p>
    <button class="btn btn-lg btn-primary w-100" onclick="agregar(${p.id})">
      Agregar al carrito
    </button>
  `;
}
